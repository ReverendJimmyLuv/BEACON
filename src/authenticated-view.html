<!-- the way it is used
<authenticated-view
        name="view-checkout"
        page="[[page]]"
        auth="[[user]]"
        route="{{route}}">
    <view-checkout
            name="view-checkout"
            route="{{route}}">
    </view-checkout>
</authenticated-view>-->



<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/iron-resizable-behavior/iron-resizable-behavior.html">

<dom-module id="authenticated-view">
    <template>
        <slot></slot>
    </template>

    <script>
        class AuthenticatedView extends Polymer.mixinBehaviors([Polymer.IronResizableBehavior], Polymer.Element) {
            static get is() {
                return 'authenticated-view'
            }

            static get properties() {
                return {
                    auth: {
                        type: Object
                    },
                    page: {
                        type: String
                    },
                    name: {
                        type: String
                    },
                    route: {
                        type: Object,
                        notify: true
                    }
                }
            }

            static get observers() {
                return [
                    '_pageChanged(page, auth)'
                ]
            }

            _pageChanged(page, auth) {
                if (page === this.name) {
                    if (auth) {
                        if (auth.isAnonymous) {
                            this.set('route.path', 'login');
                        } else {
                            var resolvedPageUrl = this.resolveUrl('beacon-' + page + '.html');
                            Polymer.importHref(resolvedPageUrl, null, null, true);
                        }
                    }
                }
            }
        }

        customElements.define(AuthenticatedView.is, AuthenticatedView);
    </script>
</dom-module>