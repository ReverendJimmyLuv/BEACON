<!--
-->
<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/geo-location/geo-location.html">
<link rel="import" href="../bower_components/vaadin-valo-theme/vaadin-combo-box.html">
<link rel="import" href="../bower_components/vaadin-combo-box/vaadin-combo-box.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/polymerfire/polymerfire.html">
<link rel="import" href="../bower_components/polymerfire/firebase-auth.html">
<link rel="import" href="../bower_components/polymerfire/firebase-query.html">
<link rel="import" href="../bower_components/polymerfire/firebase-document.html">
<link rel="import" href="shared-styles.html">
<link rel="import" href="beacon-icons.html">

<dom-module id="beacon-find">
    <template>
        <style include="shared-styles">
            :host {
                display: block;

                padding: 10px;
            }

            paper-button.orange {
                background-color: var(--paper-orange-500);
                color: white;
                --paper-button-raised-keyboard-focus: {
                    background-color: var(--paper-pink-a200) !important;
                    color: white !important;
                };
            }
        </style>

        <firebase-auth user="{{user}}" app-name="beacon"></firebase-auth>

        <firebase-query
                app-name="beacon"
                id="query"
                path="/users"
                data="{{findBeacons}}">
        </firebase-query>

        <div class="card">

            <img src="../images/manifest/beaconwhite.png" height="62" width="62">

            <h1 style="font-size:200%">Find</h1>

            <vaadin-combo-box
                    id="find1"
                    label="Find Beacons!"
                    items="[[findList]]"
                    value="{{find1}}"
                    allow-custom-value>
            </vaadin-combo-box>

            <vaadin-combo-box
                    id="find2"
                    label="Unlock more filters"
                    items=""
                    value="{{find2}}"
                    disabled>
            </vaadin-combo-box>

            <vaadin-combo-box
                    id="find3"
                    label="Unlock more filters"
                    items=""
                    value="{{find3}}"
                    disabled>
            </vaadin-combo-box>

            <br>

            <vaadin-combo-box
                    id="findDistance"
                    label="How Close to You?"
                    items="[[distanceList]]"
                    value="{{findDistance}}">
            </vaadin-combo-box>

            <br>

            <vaadin-combo-box
                    id="findTime"
                    label="When do you want it?"
                    items="[[timeList]]"
                    value="{{findTime}}">
            </vaadin-combo-box>

        </div>

        <paper-button raised class="orange">
            <iron-icon icon="beacon-icons:save"></iron-icon>
            !Save Beacon to Favorites
        </paper-button>

        <paper-button raised class="orange" on-tap="searchFindBeacons">
            <iron-icon icon="beacon-icons:search"></iron-icon>
            !Search Beacons
        </paper-button>

        <br>

        <div class="card">
            <p>Selected value: {{find1}}</p>
            <p>Selected value: {{findDistance}}</p>
            <p>Selected value: {{findTime}}</p>
            <p>{{findBeacons}}</p>
        </div>

        <div class="card">
            <template is="dom-repeat" items="{{ _makeArray(findBeacons) }}" as="data">
                <div class="profile card">
                    {{data.$key}}
                    {{data.find1}}
                </div>
            </template>
        </div>

    </template>

    <script>
        class BeaconFind extends Polymer.Element {
            static get is() {
                return 'beacon-find';
            }

            static get properties() {
                return {
                    findList: {
                        type: Array,
                        value: ['All Beacons', 'Party', 'Babysitter', 'Garage Sale', 'Study Group'],
                    },
                    distanceList: {
                        type: Array,
                        value: ['Within 1 Mile', 'Within 5 Miles', 'Within 10 Miles', 'Within 25 Miles', 'Everywhere'],
                    },
                    timeList: {
                        type: Array,
                        value: ['Now', 'Time of Day', 'Days of the Week', 'A Day Later On'],
                    },
                    find1: {
                        type: Object,
                    },
                    find2: {
                        type: Object,
                    },
                    find3: {
                        type: Object,
                    },
                    findDistance: {
                        type: Object,
                    },
                    findTime: {
                        type: Object,
                    },
                };
            }

            _makeArray(items) {
                return Object.keys(items).map(function (key) { return items[key];});
            }

            searchFindBeacons() {
                this.$.query.ref.push({
                    find1: this.$.find1.value,
                    find2: this.$.find2.value,
                    find3: this.$.find3.value,
                    findDistance: this.$.findDistance.value,
                    findTime: this.$.findTime.value
                });
            }
        }

        window.customElements.define(BeaconFind.is, BeaconFind);
    </script>
</dom-module>
