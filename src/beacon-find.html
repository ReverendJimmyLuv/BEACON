<!--
-->
<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/geo-location/geo-location.html">
<link rel="import" href="../bower_components/vaadin-valo-theme/vaadin-combo-box.html">
<link rel="import" href="../bower_components/vaadin-combo-box/vaadin-combo-box.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/polymerfire/polymerfire.html">
<link rel="import" href="../bower_components/polymerfire/firebase-auth.html">
<link rel="import" href="../bower_components/polymerfire/firebase-query.html">
<link rel="import" href="../bower_components/polymerfire/firebase-document.html">
<link rel="import" href="shared-styles.html">
<link rel="import" href="beacon-icons.html">

<dom-module id="beacon-find">
    <template>
        <style include="shared-styles">
            :host {
                display: block;
                background-color: #F29737;
                padding: 10px;
            }

            paper-button.orange {
                background-color: var(--paper-orange-500);
                color: white;
                --paper-button-raised-keyboard-focus: {
                    background-color: var(--paper-pink-a200) !important;
                    color: white !important;
                };
            }
        </style>

        <firebase-auth user="{{user}}"></firebase-auth>

        <firebase-query
                id="query"
                equalTo="{{find1}}"
                path="/beFoundBeacons"
                data="{{findBeacons}}">
        </firebase-query>

        <div class="card" style="background-color: #FFFFFF">

            <img src="../images/manifest/beaconwhite.png" height="62" width="62">

            <h1 style="font-size:200%">Find</h1>

            <vaadin-combo-box
                    id="find1"
                    label="Find Beacons!"
                    items="[[findList]]"
                    value="{{find1}}"
                    allow-custom-value>
            </vaadin-combo-box>

            <vaadin-combo-box
                    id="find2"
                    label="Unlock more filters"
                    items=""
                    value="{{find2}}"
                    disabled>
            </vaadin-combo-box>

            <vaadin-combo-box
                    id="find3"
                    label="Unlock more filters"
                    items=""
                    value="{{find3}}"
                    disabled>
            </vaadin-combo-box>

            <br>

            <vaadin-combo-box
                    id="findDistance"
                    label="How Close to You?"
                    items="[[distanceList]]"
                    value="{{findDistance}}">
            </vaadin-combo-box>

            <br>

            <vaadin-combo-box
                    id="findTime"
                    label="When do you want it?"
                    items="[[timeList]]"
                    value="{{findTime}}">
            </vaadin-combo-box>

        </div>

        <!--style="color: #000000; background-color:#ffffff"-->

        <paper-button toggles raised class="custom beeqin">
            <iron-icon icon="beacon-icons:save"></iron-icon>
            !Save Beeqin to Favorites
        </paper-button>

        <paper-button raised class="custom beeqin" on-tap="searchFindBeacons">
            <iron-icon icon="beacon-icons:search"></iron-icon>
            !Search Beeqins
        </paper-button>

        <style is="custom-style">
            /*paper-button.custom {
                --paper-button-ink-color: #000000;
                --paper-button-flat-keyboard-focus: {
                    background-color: #FFFFFF;
                    color: #F8C945 !important;
                };
                --paper-button-raised-keyboard-focus: {
                    background-color: #000000 !important;
                    color: #F8C945 !important;
                };
            }*/

            paper-button.beeqin {
                background-color: #000000;
                color: #F8C945;
            }

            paper-button.beeqin[active] {
                background-color: #F29737;
                color: #000000;
            }
        </style>

        <br>

        <!--<div class="card" style="background-color: #FFFFFF">
            <p>Selected value: {{find1}}}</p>
            <p>Selected value: {{findDistance}}}</p>
            <p>Selected value: {{findTime}}</p>
            <p>{{findBeacons}}</p>
        </div>-->

        <div id="card">
            <div id="results">
                <ul id="results-list">
                    <template is="dom-repeat" items="[[findBeacons]]" as="result">
                        <li>
                            <p class="content">[[result.found1]]</p>
                            <p class="content">[[result.found2]]</p>
                            <p class="content">[[result.found2]]</p>
                            <p class="content">[[result.beFoundDescription]]</p>
                            <p class="content">[[result.foundDistance]]</p>
                            <p class="content">[[result.foundTime]]</p>
                            <p class="content">[[result.latitude]]</p>
                            <p class="content">[[result.longitude]]</p>
                        </li>
                    </template>
                </ul>
            </div>
        </div>

        <!--<div class="card" style="background-color: #FFFFFF">
            <template is="dom-repeat" items="[[findBeacons]]">
                <div class="profile card">
                    {{item.$key}}
                    {{item.value}}
                </div>-->
                <!--<template is="dom-repeat" items="{{item.found1}}">
                    <span>{{item.beFoundDescription}}</span>
                </template>-->
            </template>
        </div>

    </template>

    <script>
        class BeaconFind extends Polymer.Element {
            static get is() {
                return 'beacon-find';
            }

            static get properties() {
                return {
                    findList: {
                        type: Array,
                        value: ['All Beacons', 'Party', 'Babysitter', 'Garage Sale', 'Study Group'],
                    },
                    distanceList: {
                        type: Array,
                        value: ['Within 1 Mile', 'Within 5 Miles', 'Within 10 Miles', 'Within 25 Miles', 'Everywhere'],
                    },
                    timeList: {
                        type: Array,
                        value: ['Now', 'Time of Day', 'Days of the Week', 'A Day Later On'],
                    },
                    find1: {
                        type: Object,
                    },
                    find2: {
                        type: Object,
                    },
                    find3: {
                        type: Object,
                    },
                    findDistance: {
                        type: Object,
                    },
                    findTime: {
                        type: Object,
                    },
                };
            }

            _makeArray(items) {
                return Object.keys(items).map(function (key) { return items[key];});
            }

            searchFindBeacons() {
                this.$.query.ref.push({
                    find1: this.$.find1.value,
                    find2: this.$.find2.value,
                    find3: this.$.find3.value,
                    findDistance: this.$.findDistance.value,
                    findTime: this.$.findTime.value
                });
            }
        }

        window.customElements.define(BeaconFind.is, BeaconFind);
    </script>
</dom-module>
